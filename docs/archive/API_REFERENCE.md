# Справочник по API

## Базовый URL
`https://api.neurographos.com/v1`

## Аутентификация
```http
Authorization: Bearer <ваш_токен>
```

## Коды состояния HTTP
- `200 OK` - Успешный запрос
- `201 Created` - Ресурс создан
- `400 Bad Request` - Неверный запрос
- `401 Unauthorized` - Требуется аутентификация
- `403 Forbidden` - Доступ запрещен
- `404 Not Found` - Ресурс не найден
- `500 Internal Server Error` - Ошибка сервера

## Эндпоинты

### Токены

#### Создать токен
```http
POST /tokens
```
**Тело запроса:**
```json
{
  "type": "text",
  "coordinates": [0.5, 0.5, 0.5],
  "metadata": {
    "title": "Пример токена",
    "description": "Описание токена"
  },
  "data": "Пример данных"
}
```

**Успешный ответ (201):**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "type": "text",
  "coordinates": [0.5, 0.5, 0.5],
  "created_at": "2025-09-23T12:00:00Z",
  "updated_at": "2025-09-23T12:00:00Z"
}
```

#### Получить токен
```http
GET /tokens/{token_id}
```

**Параметры пути:**
- `token_id` (обязательный) - UUID токена

**Успешный ответ (200):**
```json
{
  "id": "550e8400-e29b-41d4-a716-446655440000",
  "type": "text",
  "coordinates": [0.5, 0.5, 0.5],
  "metadata": {
    "title": "Пример токена",
    "description": "Описание токена"
  },
  "data": "Пример данных",
  "created_at": "2025-09-23T12:00:00Z",
  "updated_at": "2025-09-23T12:00:00Z"
}
```

### Пространственные запросы

#### Поиск в области
```http
GET /spatial/query
```

**Параметры запроса:**
- `x_min`, `y_min`, `z_min` (float) - Минимальные координаты области
- `x_max`, `y_max`, `z_max` (float) - Максимальные координаты области
- `types` (string, необязательно) - Фильтр по типам токенов (через запятую)

**Пример запроса:**
```
/spatial/query?x_min=0&y_min=0&z_min=0&x_max=1&y_max=1&z_max=1
```

**Успешный ответ (200):**
```json
{
  "results": [
    {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "type": "text",
      "coordinates": [0.5, 0.5, 0.5]
    }
  ],
  "total": 1,
  "page": 1,
  "per_page": 20
}
```

### Графовые связи

#### Создать связь
```http
POST /graph/connections
```

**Тело запроса:**
```json
{
  "source_id": "550e8400-e29b-41d4-a716-446655440000",
  "target_id": "660e8400-e29b-41d4-a716-446655440001",
  "type": "related_to",
  "weight": 0.8,
  "metadata": {
    "description": "Пример связи"
  }
}
```

**Успешный ответ (201):**
```json
{
  "id": "770e8400-e29b-41d4-a716-446655440002",
  "source_id": "550e8400-e29b-41d4-a716-446655440000",
  "target_id": "660e8400-e29b-41d4-a716-446655440001",
  "type": "related_to",
  "weight": 0.8,
  "created_at": "2025-09-23T12:00:00Z"
}
```

## Обработка ошибок

**Пример ошибки (400):**
```json
{
  "error": {
    "code": "invalid_request",
    "message": "Неверный формат координат",
    "details": {
      "coordinates": "Должен быть массивом из 3 чисел"
    }
  }
}
```

## Пагинация
Все эндпоинты, возвращающие списки, поддерживают пагинацию через параметры запроса:
- `page` - номер страницы (по умолчанию 1)
- `per_page` - количество элементов на странице (по умолчанию 20, максимум 100)

## Сортировка
Поддерживается сортировка по любому полю с помощью параметра `sort`:
- `sort=created_at` - сортировка по возрастанию
- `sort=-created_at` - сортировка по убыванию

## Версионирование API
API использует семантическое версионирование. Текущая версия: `v1`
