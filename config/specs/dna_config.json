{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DNA Subsystem Configuration",
  "description": "Configuration for DNAGuardian, CDNA slices and ADNA parameters used by system components.",
  "type": "object",
  "properties": {
    "enabled": {"type": "boolean", "default": true, "description": "Enable DNA subsystem and guardian behavior."},
    "guardian": {
      "type": "object",
      "properties": {
        "hot_slice_size_bytes": {"type": "integer", "default": 128, "description": "Default size for CDNA hot-slices (in bytes)."},
        "slice_registry_ttl": {"type": "integer", "default": 300, "description": "TTL (seconds) for cached CDNA slices in guardian cache."},
        "persistence": {
          "type": "object",
          "properties": {
            "backend": {"type": "string", "enum": ["memory", "redis", "s3"], "default": "memory"},
            "redis": {"type": "object", "properties": {"url": {"type": "string", "default": "redis://localhost:6379/0"}}},
            "s3": {"type": "object", "properties": {"bucket": {"type": "string"}, "prefix": {"type": "string"}}}
          }
        },
        "cdna_layout": {
          "type": "object",
          "properties": {
            "total_size": {"type": "integer", "default": 128},
            "blocks": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "name": {"type": "string"},
                  "offset": {"type": "integer"},
                  "size": {"type": "integer"},
                  "format": {"type": "string"},
                  "description": {"type": "string"}
                }
              }
            }
          }
        },
        "listeners": {"type": "array", "items": {"type": "string"}, "description": "List of components to notify on CDNA updates (component names)."}
      },
      "additionalProperties": false
    },
    "cdna_parsing": {
      "type": "object",
      "properties": {
        "grid_physics_layout": {"type": "string", "default": "<8H8B8f", "description": "Struct layout used to unpack GRID_PHYSICS blocks."},
        "max_dimensions": {"type": "integer", "default": 8}
      }
    },
    "adna": {
      "type": "object",
      "properties": {
        "defaults": {"type": "object", "description": "Default ADNA parameters (learning rates, resolution etc.)"},
        "overrides": {"type": "object", "description": "Per-environment overrides."}
      }
    }
  },
  "required": ["enabled"]
}
